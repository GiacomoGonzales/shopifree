/* Animaciones personalizadas para Announcement Bar */

/* Animación marquesina simple y clásica */
@keyframes slideMarqueeSimple {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-16.67%); /* 1/6 del total para 6 repeticiones */
  }
}

.announcement-slide {
  position: relative !important;
  overflow: hidden !important;
}

.announcement-slide .slide-content {
  animation: slideMarqueeSimple var(--animation-duration, 12s) linear infinite;
  white-space: nowrap;
  display: inline-flex;
  width: fit-content;
  will-change: transform;
}

/* Sin espacios entre duplicados - marquesina continua */
.announcement-slide .slide-content span {
  flex-shrink: 0;
  margin-right: 2rem; /* Pequeño espacio para separar las repeticiones */
  display: inline-block;
}

/* Animación de desvanecer (fade) - opacity */
@keyframes fadeInOut {
  0%, 100% {
    opacity: 0.7;
  }
  50% {
    opacity: 1;
  }
}

.announcement-fade {
  animation: fadeInOut var(--animation-duration, 3s) ease-in-out infinite !important;
  will-change: opacity;
}

/* Animación de rebotar (bounce) - ya existe en Tailwind pero podemos personalizarla */
@keyframes bounceCustom {
  0%, 20%, 53%, 80%, 100% {
    transform: translateY(0);
  }
  40%, 43% {
    transform: translateY(-10px);
  }
  70% {
    transform: translateY(-5px);
  }
  90% {
    transform: translateY(-2px);
  }
}

.announcement-bounce {
  animation: bounceCustom var(--animation-duration, 2s) ease-in-out infinite !important;
  will-change: transform;
}

/* Velocidades - más lentas para mejor legibilidad */
.animation-slow {
  --animation-duration: 16s;
}

.animation-normal {
  --animation-duration: 12s;
}

.animation-fast {
  --animation-duration: 8s;
}

/* Definir altura del announcement bar - debe coincidir exactamente con el padding + font-size + line-height */
:root {
  --announcement-bar-height: 41px; /* 8px + 8px padding + 14px font + ~11px line-height */
}

/* Solo cuando hay announcement bar en TOP, mover el header hacia abajo */
.nbd-theme:has(.announcement-slide[style*="top: 0"]) .nbd-header,
.nbd-theme:has(.announcement-fade[style*="top: 0"]) .nbd-header,
.nbd-theme:has(.announcement-bounce[style*="top: 0"]) .nbd-header {
  top: calc(var(--announcement-bar-height) - 1px) !important; /* Superponer 1px para eliminar gap */
  margin-top: 0 !important;
  border-top: none !important;
}

/* Ajustar la variable de altura del header cuando hay announcement bar en TOP */
.nbd-theme:has(.announcement-slide[style*="top: 0"]),
.nbd-theme:has(.announcement-fade[style*="top: 0"]),
.nbd-theme:has(.announcement-bounce[style*="top: 0"]) {
  --nbd-header-height: calc(80px + var(--announcement-bar-height));
}

/* DESKTOP: Ajustar hero section cuando hay announcement bar en TOP */
@media (min-width: 769px) {
  .nbd-theme:has(.announcement-slide[style*="top: 0"]) .nbd-hero,
  .nbd-theme:has(.announcement-fade[style*="top: 0"]) .nbd-hero,
  .nbd-theme:has(.announcement-bounce[style*="top: 0"]) .nbd-hero {
    margin-top: var(--announcement-bar-height) !important;
    padding-top: calc(var(--nbd-space-lg) + var(--announcement-bar-height)) !important;
    /* Reducir altura para que quepa en una vista */
    min-height: 75vh !important; /* Reducido de ~100vh a 75vh */
    transform: scale(0.9) !important; /* Escalar al 90% como funciona perfecto */
    transform-origin: top center !important;
  }
}

/* Cuando el announcement bar está en posición BOTTOM - limpiar espacios del header */
.nbd-theme:has(.announcement-slide[style*="top: 80px"]) .nbd-header,
.nbd-theme:has(.announcement-fade[style*="top: 80px"]) .nbd-header,
.nbd-theme:has(.announcement-bounce[style*="top: 80px"]) .nbd-header {
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  border-bottom: none !important;
  box-shadow: none !important;
  outline: none !important;
}

/* Ajustar altura total cuando announcement bar está en bottom */
.nbd-theme:has(.announcement-slide[style*="top: 80px"]),
.nbd-theme:has(.announcement-fade[style*="top: 80px"]),
.nbd-theme:has(.announcement-bounce[style*="top: 80px"]) {
  --nbd-header-height: calc(80px + var(--announcement-bar-height));
}

/* DESKTOP: Ajustar hero section cuando hay announcement bar en BOTTOM */
@media (min-width: 769px) {
  .nbd-theme:has(.announcement-slide[style*="top: 70px"]) .nbd-hero,
  .nbd-theme:has(.announcement-fade[style*="top: 70px"]) .nbd-hero,
  .nbd-theme:has(.announcement-bounce[style*="top: 70px"]) .nbd-hero {
    margin-top: var(--announcement-bar-height) !important;
    padding-top: calc(var(--nbd-space-lg) + var(--announcement-bar-height)) !important;
    /* Reducir altura para que quepa en una vista */
    min-height: 75vh !important; /* Reducido de ~100vh a 75vh */
    transform: scale(0.9) !important; /* Escalar al 90% como funciona perfecto */
    transform-origin: top center !important;
  }
}




/* ESTRATEGIA 1: Padding-top solo en la VERDADERA primera sección */
/* DESKTOP: 100px */
@media (min-width: 769px) {
  .nbd-theme:has(.announcement-slide):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-slide):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type,
  .nbd-theme:has(.announcement-fade):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-fade):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type,
  .nbd-theme:has(.announcement-bounce):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-bounce):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type {
    padding-top: 100px !important;
  }
}

/* MOBILE: 60px */
@media (max-width: 768px) {
  .nbd-theme:has(.announcement-slide):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-slide):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type,
  .nbd-theme:has(.announcement-fade):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-fade):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type,
  .nbd-theme:has(.announcement-bounce):not(:has(.nbd-hero)) .nbd-categories:first-of-type,
  .nbd-theme:has(.announcement-bounce):not(:has(.nbd-hero)) .nbd-collections-mosaic:first-of-type {
    padding-top: 60px !important;
  }
}

/* Asegurar que el announcement bar sea sticky y siempre visible */
.announcement-slide,
.announcement-fade,
.announcement-bounce {
  position: fixed !important;
  transition: all var(--nbd-transition-base, 0.3s ease);
  margin: 0 !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  /* iOS Safe Area support */
  padding-left: max(16px, env(safe-area-inset-left));
  padding-right: max(16px, env(safe-area-inset-right));
}

/* Announcement bar en posición bottom - eliminar separación */
/* DESKTOP: */
@media (min-width: 769px) {
  .announcement-slide[style*="top: 80px"],
  .announcement-fade[style*="top: 80px"],
  .announcement-bounce[style*="top: 80px"] {
    top: 70px !important; /* Ajuste para desktop */
    margin-top: 0 !important;
    padding-top: 8px !important;
    border-top: none !important;
    box-shadow: none !important;
    outline: none !important;
  }
}

/* MOBILE: pegado al header */
@media (max-width: 768px) {
  .announcement-slide[style*="top: 80px"],
  .announcement-fade[style*="top: 80px"],
  .announcement-bounce[style*="top: 80px"] {
    top: 60px !important; /* Más pegado para mobile */
    margin-top: 0 !important;
    padding-top: 8px !important;
    border-top: none !important;
    box-shadow: none !important;
    outline: none !important;
  }
}

/* Mejorar legibilidad con fondo semi-transparente si el color de fondo es muy transparente */
.announcement-slide[style*="rgba"],
.announcement-fade[style*="rgba"],
.announcement-bounce[style*="rgba"] {
  backdrop-filter: blur(8px) saturate(150%);
  -webkit-backdrop-filter: blur(8px) saturate(150%);
}